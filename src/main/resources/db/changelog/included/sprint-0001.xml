<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
	http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

<!--    <property name="now" value="sysdate" dbms="oracle"/>-->

    <changeSet id="0001-01" author="RBOU">
        <createTable tableName="CATEGORY" schemaName="DEPDATA">
            <column autoIncrement="true" name="ID" type="INTEGER">
                <constraints primaryKey="true" nullable="false"
                             primaryKeyName="CATEGORY_PK"/>
            </column>
            <column name="LABEL" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="POSITION" type="INTEGER"/>
            <column name="STATUS" type="CHAR(1)"/>
        </createTable>

        <createTable tableName="SUB_CATEGORIES" schemaName="DEPDATA">
            <column autoIncrement="true" name="ID" type="INTEGER">
                <constraints primaryKey="true" nullable="false"
                             primaryKeyName="SUB_CATEGORIES_PK"/>
            </column>
            <column name="LABEL" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="POSITION" type="INTEGER"/>
            <column name="STATUS" type="CHAR(1)"/>
            <column name="CATEGORY_ID" type="INTEGER">
                <constraints foreignKeyName="CATEGORY_SUB_CATEGORIES_fk"
                             references="DEPDATA.CATEGORY(ID)" nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="STATUS" schemaName="DEPDATA">
            <column autoIncrement="true" name="ID" type="INTEGER">
                <constraints primaryKey="true" nullable="false"
                             primaryKeyName="STATUS_PK"/>
            </column>
            <column name="LABEL" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="DESCRIPTION" type="VARCHAR(255)"/>
            <column name="STYLE_CSS" type="VARCHAR(100)"/>
            <column name="MOTIF" type="CHAR(1)"/>
        </createTable>

        <createTable tableName="DECISION" schemaName="DEPDATA">
            <column autoIncrement="true" name="ID" type="INTEGER">
                <constraints primaryKey="true" nullable="false"
                             primaryKeyName="DECISION_PK"/>
            </column>
            <column name="LABEL" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="STATUS" type="CHAR(1)"/>
            <column name="CLOSED" type="CHAR(1)"/>
            <column name="POSITION" type="INTEGER"/>
        </createTable>

        <createTable tableName="AUDIT_SITE" schemaName="DEPDATA">
            <column autoIncrement="true" name="ID" type="INTEGER">
                <constraints primaryKey="true" nullable="false"
                             primaryKeyName="AUDIT_SITE_PK"/>
            </column>
            <column name="SITE_CODE" type="VARCHAR(10)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="DATE_AUDIT" type="DATE">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="DESCRIPTION" type="VARCHAR(255)"/>
            <column name="OBSERVATION" type="VARCHAR(255)"/>
            <column name="REGION_ID" type="INTEGER"/>
            <column name="WILAYA_ID" type="INTEGER"/>
            <column name="COMMUNE_ID" type="INTEGER"/>
            <column name="STATUS_CURRENT_ID" type="INTEGER">
                <constraints foreignKeyName="AUDIT_SITE_STATUS_fk"
                             references="DEPDATA.STATUS(ID)"/>
            </column>
            <column name="CATEGORY_CURRENT_ID" type="INTEGER">
                <constraints foreignKeyName="AUDIT_SITE_CATEGORY_fk"
                             references="DEPDATA.CATEGORY(ID)"/>
            </column>
            <column name="REP_OWNER" type="VARCHAR(30)"/>
            <column name="FIRST_DECISION_ID" type="INTEGER">
                <constraints foreignKeyName="AUDIT_SITE_FIRST_DECISION_fk"
                             references="DEPDATA.DECISION(ID)"/>
            </column>
            <column name="FISRT_DECISION_DATE" type="DATE"/>
            <column name="FIRST_DECISION_ENGINEER_SITE" type="VARCHAR(100)"/>
            <column name="FIRST_DECISION_ENGINEER_OM" type="VARCHAR(100)"/>

            <column name="SECOND_DECISION_ID" type="INTEGER">
                <constraints foreignKeyName="AUDIT_SITE_SECOND_DECISION_fk"
                             references="DEPDATA.DECISION(ID)" nullable="false"/>
            </column>
            <column name="SECOND_DECISION_DATE" type="DATE"/>
            <column name="SECOND_DECISION_ENGINEER_SITE" type="VARCHAR(100)"/>
            <column name="SECOND_DECISION_ENGINEER_OM" type="VARCHAR(100)"/>

            <column name="CREATED_BY" type="VARCHAR(100)"/>
            <column name="CREATION_DATE" type="DATE"/>
            <column name="MODIFIED_BY" type="VARCHAR(100)"/>
            <column name="MODIFICATION_DATE" type="DATE"/>
        </createTable>

        <createTable tableName="AUDIT_SITE_LINE" schemaName="DEPDATA">
            <column autoIncrement="true" name="ID" type="INTEGER">
                <constraints primaryKey="true" nullable="false"
                             primaryKeyName="AUDIT_SITE_LINE_PK"/>
            </column>
            <column name="AUDIT_SITE_ID" type="INTEGER">
                <constraints foreignKeyName="AUDIT_AUDIT_SITE_fk"
                             references="DEPDATA.AUDIT_SITE(ID)" nullable="false"/>
            </column>
            <column name="CATEGORY_ID" type="INTEGER"/>
            <column name="SUB_CATEGORIES_ID" type="INTEGER">
                <constraints foreignKeyName="AUDIT_SUB_CATEGORIES_fk"
                             references="DEPDATA.SUB_CATEGORIES(ID)"/>
            </column>
            <column name="OBSERVATION" type="VARCHAR(255)"/>
            <column name="IMAGE" type="BLOB"/>
            <column name="FIRST_DECISION_ID" type="INTEGER">
                <constraints foreignKeyName="AUDIT_FIRST_DECISION_fk"
                             references="DEPDATA.DECISION(ID)"/>
            </column>
            <column name="DESCOND_DECISION_ID" type="INTEGER">
                <constraints foreignKeyName="AUDIT_SECOND_DECISION_fk"
                             references="DEPDATA.DECISION(ID)"/>
            </column>

            <column name="CREATED_BY" type="VARCHAR(100)"/>
            <column name="CREATION_DATE" type="DATE"/>
            <column name="MODIFIED_BY" type="VARCHAR(100)"/>
            <column name="MODIFICATION_DATE" type="DATE"/>
        </createTable>

        <createTable tableName="STATUS_AUDIT_SITE" schemaName="DEPDATA">

            <column autoIncrement="true" name="ID" type="INTEGER">
                <constraints primaryKey="true" nullable="false"
                             primaryKeyName="STATUS_AUDIT_PK"/>
            </column>
            <column name="STATUS_ID" type="INTEGER">
                <constraints foreignKeyName="STATUS_AUDIT_fk_1"
                             references="DEPDATA.STATUS(ID)" nullable="false"/>
            </column>
            <column name="AUDIT_SITE_ID" type="INTEGER">
                <constraints foreignKeyName="STATUS_AUDIT_fk_2"
                             references="DEPDATA.AUDIT_SITE(ID)" nullable="false"/>
            </column>
            <column name="STATUS_DATE" type="DATE"/>
            <column name="CURRENT_STATUS" type="CHAR(1)"/>
            <column name="DESCRIPTION" type="VARCHAR(255)"/>

            <column name="CREATED_BY" type="VARCHAR(100)"/>
            <column name="CREATION_DATE" type="DATE"/>
            <column name="MODIFIED_BY" type="VARCHAR(100)"/>
            <column name="MODIFICATION_DATE" type="DATE"/>
        </createTable>

    </changeSet>

    <changeSet id="0001-02" author="RBOU">
        <createSequence incrementBy="1"
                        minValue="1"
                        ordered="true"
                        schemaName="DEPDATA"
                        sequenceName="AUDIT_SITE_SEQUENCE_ID"
                        startValue="1"/>

        <createSequence incrementBy="1"
                        minValue="1"
                        ordered="true"
                        schemaName="DEPDATA"
                        sequenceName="AUDIT_SITE_LINE_SEQUENCE_ID"
                        startValue="1"/>

        <createSequence incrementBy="1"
                        minValue="1"
                        ordered="true"
                        schemaName="DEPDATA"
                        sequenceName="CATEGORY_SEQUENCE_ID"
                        startValue="1"/>

        <createSequence incrementBy="1"
                        minValue="1"
                        ordered="true"
                        schemaName="DEPDATA"
                        sequenceName="SUB_CATEGORIES_SEQUENCE_ID"
                        startValue="1"/>

        <createSequence incrementBy="1"
                        minValue="1"
                        ordered="true"
                        schemaName="DEPDATA"
                        sequenceName="STATUS_SEQUENCE_ID"
                        startValue="1"/>

        <createSequence incrementBy="1"
                        minValue="1"
                        ordered="true"
                        schemaName="DEPDATA"
                        sequenceName="DECISION_SEQUENCE_ID"
                        startValue="1"/>

        <createSequence incrementBy="1"
                        minValue="1"
                        ordered="true"
                        schemaName="DEPDATA"
                        sequenceName="STATUS_AUDIT_SITE_SEQUENCE_ID"
                        startValue="1"/>
    </changeSet>


</databaseChangeLog>